<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[The Weight]]></title>
  <link href="http://note.n6e.be/atom.xml" rel="self"/>
  <link href="http://note.n6e.be/"/>
  <updated>2016-12-21T16:13:58+09:00</updated>
  <id>http://note.n6e.be/</id>
  <author>
    <name><![CDATA[Takuo Kitame]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[move]]></title>
    <link href="http://note.n6e.be/blog/2016/12/21/move/"/>
    <updated>2016-12-21T16:13:00+09:00</updated>
    <id>http://note.n6e.be/blog/2016/12/21/move</id>
    <content type="html"><![CDATA[<p>移動しました</p>

<p><a href="http://blog.n6e.be/">http://blog.n6e.be/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[運転免許を取得したよ]]></title>
    <link href="http://note.n6e.be/blog/2016/10/14/drivers-license/"/>
    <updated>2016-10-14T23:22:00+09:00</updated>
    <id>http://note.n6e.be/blog/2016/10/14/drivers-license</id>
    <content type="html"><![CDATA[<p><img class="right" src="https://c1.staticflickr.com/1/355/30824144193_deed27acea_n.jpg">
ねんがんの うんてんめんきょを てにいれたぞ。</p>

<p>20年近く抱え込んでいたモヤモヤが解消された。<br/>
そう、僕に必要なものは運転免許証だったんだ。</p>

<!-- more -->


<p>こと、日本においては、身分証明書のデファクトスタンダードとされている運転免許証。<br/>
これがないばかりに様々な手続きで苦労をすることになる。<br/>
携帯電話やクレジットカードの契約だったり、銀行口座の開設だったり、なんらかのイベントの入場だったり。</p>

<p>いやさ、免許証以外でも身分証明可能ですけども、携帯電話の契約カウンターでパスポートを取り出す日本人などはほぼいないでしょう。<br/>
保険証は写真がないのでだめだったりするし。</p>

<p>まして住基カードは身分証明書として認めていない機関も多く、さらにマイナンバーカードを発行してしまうと住基カードは没収されてしまう。<br/>
そのマイナンバーカードはと言えば、そもそも身分証明書として使用することを禁止されている。</p>

<p>逆に免許証があれば、めんどうな手続きをスキップして口座を開設したり便利なこともある。</p>

<p>というわけで、このような動機づけやその他のモチベーションもあり、2ヶ月足らずで運転免許証を取得することができた。<br/>
効果測定や、試験の類は全て一発合格だったが、如何せん働きながらなので時間がかかってしまった。</p>

<p>まぁ、教習所が家から近いというのが最大のモチベーション維持になったかもしれない。<br/>
あとは電車でキャンプにいったらしんどかったので車欲しいみたいな強い意志もあった。<br/>
そして鴻巣の免許センターは遠すぎてもう行きたくない。</p>

<p>ともあれ、なんの障壁もなくすんなり取得できたのでよかったです。</p>

<p>めでたしめでたし。</p>

<p>続く。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[梅酒 DAY 1]]></title>
    <link href="http://note.n6e.be/blog/2016/07/09/umeshu/"/>
    <updated>2016-07-09T00:36:00+09:00</updated>
    <id>http://note.n6e.be/blog/2016/07/09/umeshu</id>
    <content type="html"><![CDATA[<p><img class="right" src="https://farm8.staticflickr.com/7608/28091290421_ff14bbd7b5_n.jpg">
僕はお酒をろくに飲めませんが、梅酒は好きなので梅酒を作ることにしました。</p>

<p>梅酒に使う青梅、それも南高梅という種類の青梅の収穫時期は 5月から6月中旬だそうです。<br/>
つまり、もうすでに時期が終わっているんですが、東北の実家の方ならば何かしら手に入るかもということでかけあってみたところ、<br/>
やや黄色がかってはいますが、2kgほど青梅を譲り受けることができましたのでチャレンジしていきたいと思います。</p>

<!-- more -->


<p>最初なので、手軽に始められる道具を選びます。<br/>
梅1kgに氷砂糖1kg、ホワイトリカー1.8リットル(一升)というのが王道だそうです。</p>

<p>ところで、Amazonではこのような漬け瓶と酒がセットのものが販売されており、これは楽そうだということで発注しました。</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00C8RA2Y2" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<p>ホワイトリカー1.8Lと4.5Lの瓶がセットになっています。評判も良さそうです。<br/>
<a href="https://www.flickr.com/photos/xnortheye/28065467982/in/album-72157662393858384/" target="_blank"><img src="https://farm8.staticflickr.com/7353/28065467982_6112ec631f_n.jpg"></a><br/>
このようにラベルも貼ってあって便利。</p>

<p>とはいえ梅が2kgあるのでもう一瓶やっておくかと思い、こちらは瓶と酒を別々に購入しました。<br/>
選んだのは、こちら。</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B0026ZP2RS" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B01DIIPHYO" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<p>あと氷砂糖と使うかわからないけどレードル。</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B0012Z3DDI" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B002DWA7LU" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<p>梅は適当に洗って十分に水気を拭き取り、ヘタを竹串で取っておきます。<br/>
本物の青梅の場合は水にしばらくつけてアク取りをするそうなんですが、今回のようなちょっと熟れた梅の場合は不要とのことです。<br/>
あと、ヘタを取るついでに竹串で梅に穴を空ける流派もあるそうですが、濁ってしまうという話も聞きますし、今回は空けずにやります。</p>

<p><a href="https://www.flickr.com/photos/xnortheye/28093023471/in/album-72157662393858384/" target="_blank"><img src="https://farm8.staticflickr.com/7511/28093023471_4259a8bd06_n.jpg"></a><br/>
↑は届いてから一日後の梅。もはや黄色いですね。</p>

<p>次に瓶の消毒なのですが、前述の酒セットの瓶では不要とのことです。<br/>
が、もうひと瓶あるので、こちらは洗剤で洗ったあと乾燥させ、梅を入れる前に焼酎を少々いれて回すなどして消毒しました。<br/>
まぁ、調べたところによると35度の酒を使う場合はあんまり神経質にならなくても良いらしいです。<br/>
カビの原因は往々にして20度前後の酒を使っているからだ、と。</p>

<p>あとは梅と氷砂糖を少量ずつ交互に瓶に入れていくんですが、酒がセットになった瓶の欠点がここで出てきました。<br/>
最初から酒が入っているので梅や砂糖を入れるときにポチャポチャと酒が跳ねる。瓶から酒が跳ねでないようにするのにわりと神経使いました。<br/>
まぁ次からセットで買うことも無かろうよ。<br/>
<a href="https://www.flickr.com/photos/xnortheye/27554020244/in/album-72157662393858384/" target="_blank"><img src="https://farm8.staticflickr.com/7432/27554020244_06a8654177_n.jpg"></a></p>

<p>さて、砂糖の量は1kgだとかなり甘いらしいので、今回は 800gと700gで調整しています。<br/>
あとは毎日瓶を回すなどして糖分が均一になるように維持すれば良いとのことです。</p>

<p>漬ける期間の目安は3ヶ月～1年らしいのでまだまだ先ですが楽しみであります。<br/>
<a href="https://www.flickr.com/photos/xnortheye/28095408531/in/album-72157662393858384/" target="_blank"><img src="https://farm8.staticflickr.com/7769/28095408531_335438b20a_n.jpg"></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[BOSE SOUNDLINK mini Bluetooth speaker II]]></title>
    <link href="http://note.n6e.be/blog/2016/02/16/bose-soundlink-mini-ii/"/>
    <updated>2016-02-16T18:26:00+09:00</updated>
    <id>http://note.n6e.be/blog/2016/02/16/bose-soundlink-mini-ii</id>
    <content type="html"><![CDATA[<p><img class="right" src="https://farm6.staticflickr.com/5699/23987335841_6813a7a912_n.jpg">
というわけで、<a href="http://note.n6e.be/blog/2016/01/24/anker-bluetooth-premium-speaker-a3143/">前回</a>に引き続き小型BTスピーカーの購入記録です。<br/>
前回はAnkerのA3143でしたが、こいつの問題点は強烈なホワイトノイズでした。<br/>
しかしながら、音質面ではそこそこであり、値段を考えると妥当という一品です。</p>

<p>今回はいわゆるBOSEの、つまりBOSEの高級スピーカー SOUNDLINK mini なわけですが、
値段は27000円前後とAnkerのものにくらべると実に5倍くらいします。<br/>
めちゃ高いですね。<br/>
それでも、僕は、BOSEを、信じていますので。<br/>
なんの躊躇いもなく購入してみました。</p>

<p><em>BOSE SOUNDLINK mini Bluetooth speaker II</em> ( <a href="http://www.bose.co.jp/jp_jp?url=/consumer_audio/multimedia_speakers/bluetooth_speakers/soundlink_mini/slmini.jsp">商品詳細</a> )</p>

<!-- more -->


<p>まず音ですが、悪くないです。Ankerのも悪くなかったどぇすが、それ以上に悪くない感じです。<br/>
まぁ所詮は10W+10Wなんでお察しなんですけど。<br/>
いわゆるドンシャリ。低音が強めの。<br/>
なので人によってはこもった感じに聞こえるかも知れませんが、僕は好きです。</p>

<p>Anker 7点として BOSEは9点としておきます。<br/>
適当です。</p>

<p>で、気になるホワイトノイズですが、やはり気になります。<br/>
それでもAnkerのにくらべると半分くらいなので、ギリギリ枕元用途には耐えられそうです。<br/>
有線にした場合どうなのかという検証は行っておりません。<br/>
<a href="https://www.flickr.com/photos/xnortheye/24439850183/in/album-72157662393858384/" target="_blank"><img src="https://farm2.staticflickr.com/1662/24439850183_1280c7a185_n.jpg"></a></p>

<p>大きさはさほど変わりません。メガネケースよりすこし大きいくらいのその大きさです。<br/>
<a href="https://www.flickr.com/photos/xnortheye/23774247940/in/album-72157662393858384/" target="_blank"><img src="https://farm6.staticflickr.com/5625/23774247940_f2ca10b594_n.jpg"></a></p>

<p>結局のところ27000円も払って買うかと言われると微妙なので、BOSE好きでもなければやめたほうがいいですね。
ちなみに防水ではありません。</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00YMCA3V8" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B015R0MIC0" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Anker プレミアムステレオスピーカー Bluetooth 4.0 (A3143)]]></title>
    <link href="http://note.n6e.be/blog/2016/01/24/anker-bluetooth-premium-speaker-a3143/"/>
    <updated>2016-01-24T13:07:00+09:00</updated>
    <id>http://note.n6e.be/blog/2016/01/24/anker-bluetooth-premium-speaker-a3143</id>
    <content type="html"><![CDATA[<p><a href="https://lh3.googleusercontent.com/-Ab6EfOFCIoY/VqRNaJOflxI/AAAAAAAAedE/w65ow5hUxMU/s800-Ic42/DSC01724.JPG" target="_blank"><img class="right" src="https://lh3.googleusercontent.com/-Ab6EfOFCIoY/VqRNaJOflxI/AAAAAAAAedE/w65ow5hUxMU/s288-Ic42/DSC01724.JPG"></a>
みなさんこんばんは！<br/>
音楽、聴いてますか！？<br/>
今回は、小柄で大変便利なスピーカーであるところの、表題の商品を購入した件についてお知らせです。</p>

<!-- more -->


<p>リビングではChromecastつかってAVアンプで音楽を再生したりしているのだが、<br/>
寝室でもスマートフォンなどに入っている音楽資産を効率的に再生したいという思いがあり、<br/>
この一見良さそうなスピーカーを購入した次第です。</p>

<p>音質的な印象は低音でかめで、個人的には好きな感触。<br/>
出力も10Wx2なので、小型にしてはそこそこという感じか。</p>

<p>ユーティリティとしてはBT4.0のほかにミニジャックのAUX、USBによる電源供給、バッテリ駆動とまぁ基本的なスペックで、<br/>
サイズも小さく、わりと問題ない。</p>

<p>しかしだ。</p>

<p>このスピーカー、ホワイトノイズがものすごい。<br/>
もしかして初期不良かと思ったりもしたが、いろんなレビューを目にするとどうやら仕様の模様。<br/>
ともかく、スピーカーをそばにしての再生では耳障りなので無理がある。寝室の枕元に設置など以ての外である。<br/>
BT経由の再生ではホワイトノイズがのるはまぁしかたのないのかもしれないが、それにしてもひどいのである。</p>

<p>広くて雑な空間、パーティ会場や屋外などでは、価格も手頃だし大変便利かもしれない。<br/>
しかしながら、当方の用途が寝室設置だったので残念ながらこれはキッチンの側において雑に再生するようにすることにした。</p>

<p>そんなわけで、次回は BOSE SOUNDLINK MINI IIを購入した件について書きます。</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B015R0MIC0" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Qualcomm IZat のメモリリーク]]></title>
    <link href="http://note.n6e.be/blog/2015/08/24/qualcomm-izat-memory-leak/"/>
    <updated>2015-08-24T23:40:00+09:00</updated>
    <id>http://note.n6e.be/blog/2015/08/24/qualcomm-izat-memory-leak</id>
    <content type="html"><![CDATA[<p><a href="http://note.n6e.be/assets/screenshot/QualcommIZat.png" target="_blank"><img class="right" src="http://note.n6e.be/assets/screenshot/QualcommIZat.png" width="240" height="230"></a>
QualcommのSoCにIZatというテクノロジーがあって、これは位置情報の効率化を図るハードウェア支援だそうです。<br/>
au版のXperia Z3ではこれを有効化できるのですが、どうやらメモリリークが存在するようでした。</p>

<!-- more -->


<p>IZatを有効化するとlowi-serverというのが働き出してどんどんメモリを食っていきます。<br/>
<img src="http://note.n6e.be/assets/screenshot/lowi-server.png" width="640" height="601">
こんな感じです。<br/>
6日間で366MBになっています。</p>

<p>この状態だとあらゆるバックグラウンドアクティビティはシステムによってkillされまくり、ウェブブラウザもホームに戻る度にロードし直しで不快極まりないです。<br/>
通知を握りつぶされることもままあります。</p>

<p>しかもこいつはシステムプロセスなので、root権がなくてはkillすることもできず、こうなってしまったら端末を再起動するしかありません。</p>

<p>ちなみにlogcatしているとなにやら延々とエラーがでていますがよくわかりません。</p>

<figure class='code'><figcaption><span>logcat</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>W/LOWI-SERVER(  485): [LOWIController] Error in getting response from cache
</span><span class='line'>W/LOWI-SERVER(  485): [LOWIScanResultReceiver] No result, due to terminate or no memory
</span></code></pre></td></tr></table></div></figure>


<p>というわけで、こんなもんは使わないほうが良いです。<br/>
さっさとOFFにして再起動しましょう。(ちなみにデフォルトOFFです)<br/>
OFFであれば0.3MB程度しか消費しません。</p>

<p>docomoやソフトバンクのZ3ではそもそも有効化できないので心配いりません。Z4は知りませんが。</p>

<p>現場からは以上です。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[さくらのVPS x LXC x IPv6]]></title>
    <link href="http://note.n6e.be/blog/2015/04/08/sakura-vps-lxc-ipv6/"/>
    <updated>2015-04-08T15:39:00+09:00</updated>
    <id>http://note.n6e.be/blog/2015/04/08/sakura-vps-lxc-ipv6</id>
    <content type="html"><![CDATA[<p>こんにちは。<br/>
さくらのVPSで使えていた<a href="http://research.sakura.ad.jp/6rd-trial/">6rdトライアルが3/31で終わってしまいました</a>。</p>

<p>ところで、だいぶ前からさくらのVPSではネイティブなIPv6アドレスが配布され、利用できていました。(<a href="http://www.sakura.ad.jp/news/sakurainfo/newsentry.php?id=925">「さくらのVPS」大阪リージョン IPv6アドレス提供開始のお知らせ</a>)<br/>
しかしながら、配布されているアドレスは1個のみで使い勝手がよくなく、それが6rdを最後まで使っていた理由でもありました。</p>

<p>まぁサービスが終わってしまったのなら移行せざるを得ないということで重い腰を上げて作業した次第です。</p>

<!-- more -->


<h2>さくらVPSのIPv6</h2>

<p>前述の通り、現在さくらVPSで使えるIPv6はネイティブ接続になっています。<br/>
単純にVPSでIPv6アドレスを使うだけなら以下の設定だけで十分です。</p>

<figure class='code'><figcaption><span>/etc/network/interfaces</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>iface eth0 inet6 static
</span><span class='line'>        address 2403:3a00:202:1202:xxx:xxx:xxx:xxx
</span><span class='line'>        netmask 64
</span><span class='line'>        gateway fe80::1
</span></code></pre></td></tr></table></div></figure>


<p>ですが、うちのようにVPSでLXCを構成して、各種サービスはそれぞれのコンテナ内でうごかしているような環境の場合、IPv6でサービスにアクセスするには各コンテナにアドレスを振るか、IPv4のようにNATする必要があります。</p>

<p>6rdトライアルでは/64のネットワークアドレスを使えたのでブリッジに対してアドレスを広告してあげれば済みましたが、現状のIPv6は1個しかアドレスがないのでこれをどうにかしてshareするしかありません。<br/>
(BSD系のjailではうまくshareできるようですがよく知りません)</p>

<h2>IPv6でNAT</h2>

<p>IPv6でNATなんていうのは極めてnonsenseで非常にevilですがアドレスが一個しかない以上仕方がありません。<br/>
さくらの人間は<a href="https://tools.ietf.org/html/rfc6177">RFC6177</a>を読んでいるのでしょうか。<br/>
ともかく、<a href="http://mirrors.bieringer.de/Linux+IPv6-HOWTO/nat-netfilter6..html">Linux(3.9.0以降, iptables-1.4.18以降)ではIPv6でもNATできる</a>ようなのでやってみることにしました。</p>

<p>とりあえずカーネルとiptablesのバージョンに問題なければIPv4と全く同じようにNATできるとのことです。</p>

<p>まずLXCのコンテナと通信するためのbridgeを確認します。</p>

<pre><code>% brctl show lxcbr0
bridge name bridge id       STP enabled interfaces
lxcbr0      8000.fe59f8967f7c   no      vm00eth0
                                vm01eth0
                                vm02eth0
                                vm03eth0
                                vm04eth0
% ifconfig lxcbr0
lxcbr0    Link encap:イーサネット  ハードウェアアドレス fe:59:f8:96:7f:7c 
          inetアドレス:10.0.0.1 ブロードキャスト:10.0.0.255  マスク:255.255.255.0
          inet6アドレス: fe80::fc59:f8ff:fe96:7f7c/64 範囲:リンク
</code></pre>

<p>vm00内の<code>eth0</code>は…</p>

<pre><code>% ifconfig eth0
eth0      Link encap:イーサネット  ハードウェアアドレス 00:ff:00:00:00:03 
          inetアドレス:10.0.0.3 ブロードキャスト:10.0.0.255  マスク:255.255.255.0
          inet6アドレス: fe80::2ff:ff:fe00:3/64 範囲:リンク
</code></pre>

<p>まぁこんな感じですので、<code>lxcbr0</code> のリンクローカルを使って <code>fe80::2ff:ff:fe00:3</code> へDNATしたいと思います。</p>

<pre><code># ip6tables -t nat -I PREROUTING -p tcp -d 2403:3a00:202:1202:xxx:xxx:xxx:xxx -j DNAT --to-destination fe80::2ff:ff:fe00:3
</code></pre>

<p>とやれば良さそうに思いましたが、うまく行きませんでした。  <br/>
<em>tcpdump</em>で覗けばわかりますが、<em>neighbor solicitation</em>に失敗しています。<br/>
はい、リンクローカルはデバイス(<em>scope id</em>)を指定しなければうまく通信できません。<br/>
<em>ping6</em> でもリンクローカルは <code>-I eth0</code> でインターフェースを指定したり、アドレスに<code>%eth0</code>をつけるなどしないと通りませんね。<br/>
そんなわけで、</p>

<pre><code># ip6tables -t nat -I PREROUTING -p tcp -d 2403:3a00:202:1202:xxx:xxx:xxx:xxx -j DNAT --to-destination fe80::2ff:ff:fe00:3%lxcbr0
ip6tables v1.4.21: Bad IP address "fe80::2ff:ff:fe00:3%lxcbr0"
</code></pre>

<p>などとやってみますが、拒否されました。<br/>
なるほど、iptablesでは<em>scope id</em>を指定できないのですね。<br/>
というわけで、リンクローカルはあきらめて<a href="https://www.nic.ad.jp/ja/newsletter/No30/022.html">Unique Local IPv6 Unicast Address (ULA)</a>を使います。<br/>
ともかく使うアドレスは<code>fd00::/8</code>でよさそうです。</p>

<p>コンテナからの戻りのrouteも必要ですので<em>masquerade</em>します。</p>

<pre><code># ip addr add fd00::1/8 dev lxcbr0
# ip6tables -t nat -I PREROUTING -p tcp -d 2403:3a00:202:1202:xxx:xxx:xxx:xxx --dport 80 -j DNAT --to-destination fd00::3
# ip6tables -t nat -I PREROUTING -p udp -d 2403:3a00:202:1202:xxx:xxx:xxx:xxx --dport 53 -j DNAT --to-destination fd00::3
# ip6tables -t nat -I POSTROUTING -s fd00::/8 -o eth0 -j MASQUERADE
</code></pre>

<p>LXCコンテナでは</p>

<pre><code># ip addr add fd00::3/8 dev eth0
# ip -6 ro add default via fd00::1 dev eth0
</code></pre>

<p>結局の所、ULAをプライベートアドレスに読みかえれば、IPv4と同じオペレーションでNATができるようになるということです。</p>

<h2>フィルタリングファイウォール</h2>

<p>IPv6でアクセスできることを確認したらIPv4と同じようにフィルタリングしておきましょう。<br/>
これもIPv4のiptablesとまったく同じように設定します。</p>

<pre><code># ip6tables -I INPUT -P DROP   # default でDROP
# ip6tables -I FORWARD -P DROP # default でDROP
# ip6tables -A FORWARD -p tcp -m multiport --dports 80,443 -j ACCEPT
# ip6tables -A FORWARD -p udp -m multiport --dports 53,123 -j ACCEPT
(以下略)
</code></pre>

<p>以上です。<br/>
あとはさくらVPSがせめて/64くれるようになることを祈るだけですね。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ドメイン名が変わりました]]></title>
    <link href="http://note.n6e.be/blog/2015/01/09/domain-name-changed/"/>
    <updated>2015-01-09T20:52:00+09:00</updated>
    <id>http://note.n6e.be/blog/2015/01/09/domain-name-changed</id>
    <content type="html"><![CDATA[<p><img class="right" src="http://note.n6e.be/assets/screenshot/aws-domain-name-registration.png">
ドメインを変更することになりました。<br/>
新しいドメインは n6e.be です。</p>

<!-- more -->


<p>ga.vg ドメインは2文字でそんなに高額でもなく気に入っていたんですが、昨年のいつ頃だったかに .vg ドメインの管理団体が破産したとか何とかで変更になり、
以後の更新料は年間1万円を超えるようになってしまいました。<br/>
さすがに年1万はな〜ってなって変更することにいたしました。</p>

<p>今度も3文字で比較的短いドメインなのですが、やっぱり2文字がよかったなという思いは残ります。</p>

<p>さて、今回ドメイン取得にあたり、AmazonのRoute53サービスを利用してみました。<br/>
ちなみにRoute53はバックエンドレジストラに<a href="http://www.gandi.net">Gandi</a>を利用しているようです。</p>

<p>.be ドメインは $9 で取得でき、他のドメイン販売業者と比べても対して差がありません。<br/>
.jp ドメインも $90 で大きく変わらないのですが、まぁ円安ということもあり、円換算すると少々高くなりますね。</p>

<p>取得自体はAWSのマネジメントコンソールから適当にポチポチやってれば買えます。<br/>
新規ドメインの場合は、自動的にDNSのホスティングもRoute53になります。<br/>
もちろん外のDNSに変更も可能ですが、APIもあるしDDNSもやりやすいだろうと思ってこのまま運用することにしました。<br/>
費用としては $0.5/zoneに加えて10億クエリまでは $0.4 で、だいたい $1/month で運用できていますし、気になる額でもありません。<br/>
<img src="http://note.n6e.be/assets/screenshot/aws-route53-price.png"></p>

<p>DDNSなどに用いるコマンドラインツールは <a href="https://github.com/barnybug/cli53">cli53</a> というPythonツールを使っています。</p>

<figure class='code'><figcaption><span>command line</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo pip install cli53
</span></code></pre></td></tr></table></div></figure>


<p>という具合にpipでインストール。<br/>
あとは /etc/ppp/ip-up.d/ddns あたりに適当にかいとけばDDNSできます。</p>

<figure class='code'><figcaption><span>/etc/ppp/ip-up.d/ddns</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/bin/sh</span>
</span><span class='line'><span class="nb">set</span> -e
</span><span class='line'>
</span><span class='line'><span class="nb">export </span><span class="nv">AWS_ACCESS_KEY_ID</span><span class="o">=</span>XXXXXXXXXXXXXXXXXXXXXXXXXXX
</span><span class='line'><span class="nb">export </span><span class="nv">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
</span><span class='line'>
</span><span class='line'><span class="c"># dynamic.n6e.be をTTL 90で登録</span>
</span><span class='line'>cli53 rrcreate n6e.be dynamic A <span class="nv">$PPP_LOCAL</span> --ttl 90 --replace
</span></code></pre></td></tr></table></div></figure>


<p>便利です。</p>

<p>今後共よろしくお願いいたします。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Anker 3 Micro USB Cables]]></title>
    <link href="http://note.n6e.be/blog/2014/12/01/anker-3-micro-usb-cables/"/>
    <updated>2014-12-01T22:44:00+09:00</updated>
    <id>http://note.n6e.be/blog/2014/12/01/anker-3-micro-usb-cables</id>
    <content type="html"><![CDATA[<p><img class="right" src="https://lh5.googleusercontent.com/-5_DtA9BE1LQ/VH1j1Pf3N3I/AAAAAAAAUIM/T0rE9Ipyxu8/s288/IMGP1003_1.jpg">
こんにちは。<br/>
本日はお手頃なMicroUSBケーブルのご紹介です。</p>

<!-- more -->


<p>USBで充電する機材が増えてくるとケーブルもそれなりに数を用意する必要も出てきます。<br/>
付属されている純正のケーブルでも良いのですが、充電する場所は一箇所ではないし、ケーブルは充電器の方に挿しっぱなしにしておきたい気持ちもあります。</p>

<p>そんなわけで、お手頃なケーブルを探していた所、<a href="http://www.amazon.co.jp/dp/B00IDTILEW/takuojp02-22/">USB充電器ACアダプタ</a>や<a href="http://www.amazon.co.jp/dp/B00DQ7590A/takuojp02-22/">モバイルバッテリー</a>でおなじみのAnkerから3本セットのよさ気なケーブルが出ていたので買いました。</p>

<p><a href="http://www.amazon.co.jp/dp/B00NAQITHW/takuojp02-22/">Anker【3本セット】 90cm Micro USB ケーブル ハイスピード USB 2.0 Aオス型-B同期 充電用ケーブル</a></p>

<p><a href="https://picasaweb.google.com/lh/photo/iiN96pA4hiE5DvOnonYoFHZWRChvnQd215ra2-hbqbQ?feat=embedwebsite" target="_blank"><img src="https://lh6.googleusercontent.com/-QSMvMMSSgHE/VH1j5d6DqfI/AAAAAAAAUIY/eodDnDumVCY/s400/IMGP1002_1.jpg"></a></p>

<p>こんな感じのが3本入っていて1000円強と、購入しやすい価格になっています。</p>

<p>ケーブルの良し悪しなんてのはまぁ体感できるもんでもないのでモノのレビューは避けますが、とりあえずお手頃にまともなケーブルが手に入るのは良かったです。</p>

<p>蛇足且つ今更ですが AnkerのUSB急速充電器ACアダプタは初期ロットに問題はあったものの、現行ロットでは修正済とのことで、こちらも大変便利なのでオススメです。</p>

<p>うちでは2台購入(初期ロット)して2台とも一部ポートが使用できない不具合が出たので、サポートに対応してもらい現行ロットのものを送ってもらいました。(5日ほどでAmazonから発送されてきた)</p>

<p>以上です。</p>

<p>評価: ★★★★★</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00NAQITHW" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00IDTILEW" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00DQ7590A" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NETGEAR GS116E]]></title>
    <link href="http://note.n6e.be/blog/2014/08/07/netgear-gs116e/"/>
    <updated>2014-08-07T22:01:00+09:00</updated>
    <id>http://note.n6e.be/blog/2014/08/07/netgear-gs116e</id>
    <content type="html"><![CDATA[<p>VLANを切れる安価なスイッチングハブ NETGEAR GS116E を買ってみた。</p>

<p>PPPoEのセグメントとPrivate LANのセグメントで2つのハブを使っていたのだけれど、機材を減らしたいと思いVLAN設定ができる安めのハブを探していたところ、NETGEAR製品くらいしかなさそうだったので16ポートのこいつを選んだ。</p>

<!-- more -->


<p>結論から言えば、家庭用としては大変コストパフォーマンスに優れた機材ではある、しかし若干悪いクセがあるように思えるのでちょっと書いてみる。</p>

<h3>設定ツールはAdobe AIRだけどWebもある</h3>

<p>悪いとこのひとつは設定ツールがAdobe AIRアプリであり、Windows向けにしかないこと。<br/>
まぁこれは一度IPアドレスを設定しちゃえば Web UI が使えるようになるので不要ではあるのだが、初期設定時にether portがついたWindowsマシンがないと詰む。</p>

<p>Web UIはこんな感じで、できることはAIRのアプリと同じ。<br/>
<a href="http://note.n6e.be/assets/screenshot/gs116ev2-web-ui.png" target="_blank"><img class="right" src="http://note.n6e.be/assets/screenshot/gs116ev2-web-ui.png" title="WEB UI" ></a></p>

<p>UI的にVLANの設定は若干わかりにくいかも知れない。</p>

<h3>ポートベースVLANは使うべきではない</h3>

<p>基本ポートベースVLANという機能があるが、これは使いものにならない(と思う)。<br/>
これでVLANを切ってみたらホストによっては</p>

<blockquote><p>br0: received packet on eth1 with own address as source address</p></blockquote>


<p>といったようなログが出るようになり、通信がままならなくなった。<br/>
まぁ素直に802.1QのAdvancedモードを使うように設定すればいいし、これが欠点とはならない。</p>

<h3>謎のパケット破棄ルールがある?</h3>

<p>一番よくない点として、どうも独自の判断でIPパケットを破棄している節がある。<br/>
確認しているのはPPPoEのセッションパケットで、中身のIP DestinationとSourceが同じアドレスのパケットを捨てていた。</p>

<p>そもそもこんなパケットが外に行こうとすることがおかしいといえばおかしいのだが、例を挙げればYAMAHAのRTシリーズのNATはこういう仕様になっていて、<br/>
LAN内やルーター自身から、ルーターのWANアドレス宛に通信しようとするとこういうパケットになり、一旦PPPoEのpeer先へパケットを投げる模様。<br/>
実際に ping の応答に 5msec ほどかかっており、ルーター内部で完結しているとは言いがたいレイテンシになっている。</p>

<p>さて、話を戻してWANアドレスにpingしながら、YAMAHAのルーターをつないだGS116Eのポートをミラーリングしてtcpdumpしているとこんな感じのパケットがきているのが見られる。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> PPPoE  [ses 0x7b6d] IP 1xx.1yy.74.199 &gt; 1xx.1yy.74.199: ICMP echo request, id 61399, seq 1, length 64
</span><span class='line'> PPPoE  [ses 0x7b6d] IP 1xx.1yy.74.199 &gt; 1xx.1yy.74.199: ICMP echo request, id 61399, seq 2, length 64
</span><span class='line'> PPPoE  [ses 0x7b6d] IP 1xx.1yy.74.199 &gt; 1xx.1yy.74.199: ICMP echo request, id 61399, seq 3, length 64</span></code></pre></td></tr></table></div></figure>


<p>このパケットはONUが繋がっている本来流れるべきポートへは流れていかないし(これもミラーリングで確認)、戻ってもいないのでGS116E内で破棄されていると考えられる。</p>

<p>こういうへんなNAT仕様のYAMAHAルーターも大概ではあるけれど、L2スイッチごときがL3の条件でパケットを勝手に捨てるのはいかがなものかと思う。(調べたら過去にIPv6パケットを捨ててるとかいう疑惑があった模様)<br/>
まぁ稀なケースなので我慢することにしたが、いわゆるヘアピンNAT( <a href="http://www.rfc-base.org/txt/rfc-4787.txt">RFC4748</a> )などといわれる機能に頼る環境では注意である。</p>

<h3>総評</h3>

<p>ともあれ、安価でVLAN切れてWeb UIで設定でき、ポートミラーリングでこういったトラブルシューティングができるのはなかなかよいかなと思う。(あくまで家庭用では)</p>

<p>評価: ★★★☆☆</p>

<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B00GQL3U2M" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-fe.amazon-adsystem.com/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B004LV1SL4" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[近況]]></title>
    <link href="http://note.n6e.be/blog/2014/08/06/kinkyo/"/>
    <updated>2014-08-06T17:54:00+09:00</updated>
    <id>http://note.n6e.be/blog/2014/08/06/kinkyo</id>
    <content type="html"><![CDATA[<p>近況です。</p>

<p>とくにネタもなかったので放っておいてましたが、最近わりとモノを買うようになったので買ったものレビューでもしていこうかと思います。</p>

<p>以上です。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[CyanogenMod で DTCP-IP やパズドラを動かす]]></title>
    <link href="http://note.n6e.be/blog/2013/07/11/cyanogenmod-dtcp-ip/"/>
    <updated>2013-07-11T23:49:00+09:00</updated>
    <id>http://note.n6e.be/blog/2013/07/11/cyanogenmod-dtcp-ip</id>
    <content type="html"><![CDATA[<p>CyanogenMod でもパズドラを起動したいとです！！！</p>

<!-- more -->


<p>というわけなんですが、パズドラとかどうでもよくて TwonkyBeam の DTCP-IP を使いたいというが目的で調べました。<br/>
要するに root チェックにより CyanogenMod のようなカスタムROMでは使用できないアプリを動かすというやつです。</p>

<p>インターネットで調べると以下のような項目でroot端末かどうかをチェックしているようです。</p>

<ul>
<li><strong>su バイナリの存在</strong> /system/{bin,xbin}, /sbin あたりにsu があるとダメなようです</li>
<li><strong>/system/app/Superuser.apk の存在</strong> (CyanogenModにはないですがリネームすればいいだけです)</li>
<li><strong>getprop <em>ro.secure</em> の値が0だとNG</strong> (CyanogenModでは1なので問題ないです)</li>
<li><strong>getprop <em>ro.debuggable</em> の値が1だとNG</strong> (CyanogenModでは1なので対策が必要です)</li>
</ul>


<p><strong>su のバイナリ</strong> は <em>/system/bin/su</em>, <em>/system/xbin/su</em> にあるので適当にリネームして回避出来ますが、リネームしっぱなしだと root が必要なアプリを実行するときにこまるのでこんなスクリプトを書いてみました。</p>

<p>まずシステムの起動時に実行される <em>/data/local/userinit.sh</em> で <strong>su</strong> を <strong>sux</strong> にリネームして隠します。</p>

<figure class='code'><figcaption><span>/data/local/userinit.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/system/bin/sh</span>
</span><span class='line'>
</span><span class='line'>mount -o remount,rw /system
</span><span class='line'>
</span><span class='line'><span class="c">#</span>
</span><span class='line'><span class="c"># su を退避 symlinkの場合は無視</span>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> -x /system/bin/su -a ! -L /system/bin/su <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">    </span>mv /system/bin/su /system/bin/sux
</span><span class='line'><span class="k">fi</span>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> -x /system/xbin/su -a ! -L /system/xbin/su <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">    </span>mv /system/xbin/su /system/xbin/sux
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'>mount -o remount,ro /system
</span></code></pre></td></tr></table></div></figure>


<p>次に su があれば削除し、なければ sux から symlink を貼るというようなスクリプトです。</p>

<figure class='code'><figcaption><span>/data/local/swsu.sh</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#!/system/bin/sh</span>
</span><span class='line'>
</span><span class='line'><span class="c"># rootじゃない場合sux使ってrootになる</span>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> <span class="sb">`</span>whoami<span class="sb">`</span> !<span class="o">=</span> <span class="s2">&quot;root&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">  </span>sux -c <span class="nv">$0</span>
</span><span class='line'>  <span class="nb">exit</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'>mount -o remount,rw /system
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> ! -L /system/xbin/su <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">  </span>ln -s /system/xbin/sux /system/xbin/su
</span><span class='line'>  ln -s /system/bin/sux /system/bin/su
</span><span class='line'>  <span class="nb">echo</span> <span class="s2">&quot;enable su&quot;</span>
</span><span class='line'><span class="k">else</span>
</span><span class='line'><span class="k">  </span>rm -f /system/xbin/su
</span><span class='line'>  rm -f /system/bin/su
</span><span class='line'>  <span class="nb">echo</span> <span class="s2">&quot;disable su&quot;</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'>
</span><span class='line'>mount -o remount,ro /system
</span></code></pre></td></tr></table></div></figure>


<p>どちらも配置したら <strong>chmod 0755</strong> するのを忘れずに。</p>

<p>ひとまずこれで再起動してみて試します。<br/>
<strong>/data/local/swsu.sh</strong> は <a href="https://play.google.com/store/apps/details?id=com.ryo.commandRunner">CommandRunner</a> とかで起動したら良いでしょう。<br/>
ショートカットも作れるので便利です。<br/>
実行してみて su の存在をトグルできるようになってればOKです。<br/>
※ root をトグルするアプリも存在しますが、挙動を把握しやすくするため今回は自分でスクリプト書きました。</p>

<p>さて、次に <strong>getprop</strong> の値。まず <strong>/default.prop</strong> の値が云々的な説明をしているサイトがありますが間違いです。<br/>
目的のプロパティは <strong>boot.img</strong> の中、 <strong>initrd.img</strong> にある <strong>default.prop</strong> により設定されてます。(んでその initrd が / にマウントされる)<br/>
そんなわけで <strong>boot.img</strong> をいじる必要があります。結構めんどいです。</p>

<p>まず <strong>boot.img</strong> を <em>update.zip</em> から取り出しておきます。<br/>
<strong>boot.img</strong> の展開と再構築には Linux上で <em>abootimg</em> を使いますが、WindowsやMacでもなんとかする方法はあると思いますので頑張って。</p>

<figure class='code'><figcaption><span>terminal</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo apt-get install abootimg unzip
</span><span class='line'><span class="nv">$ </span>wget http://get.cm/get/jenkins/34073/cm-10.1.1-grouper.zip
</span><span class='line'><span class="nv">$ </span>mkdir bootimg
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>bootimg
</span><span class='line'><span class="nv">$ </span>unzip ../cm-10.1.1-grouper.zip boot.img
</span><span class='line'><span class="nv">$ </span>abootimg -x boot.img
</span><span class='line'><span class="nv">$ </span>mkdir initrd
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>initrd
</span><span class='line'><span class="nv">$ </span>zcat ../initrd.img | cpio -i
</span><span class='line'><span class="nv">$ </span>sed -e <span class="s1">&#39;s/ro.debuggable=1/ro.debuggable=0/g&#39;</span> default.prop &gt; default.prop.new
</span><span class='line'><span class="nv">$ </span>mv default.prop.new default.prop
</span><span class='line'><span class="nv">$ </span>find . | cpio -o -H newq | gzip &gt; ../initrd.img
</span><span class='line'><span class="nv">$ </span><span class="nb">cd</span> ..
</span><span class='line'><span class="nv">$ </span>abootimg --create newboot.img -k zImage -r initrd.img
</span></code></pre></td></tr></table></div></figure>


<p>で、<strong>newboot.img</strong> ができたらひとまず <em>fastboot</em> から起動してみます。</p>

<figure class='code'><figcaption><span>terminal</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>adb reboot bootloader
</span><span class='line'><span class="nv">$ </span>sudo fastboot boot newboot.img
</span><span class='line'><span class="nv">$ </span>adb shell
</span><span class='line'>
</span><span class='line'>shell@android:/ <span class="nv">$ </span>getprop ro.debuggable
</span><span class='line'>0
</span><span class='line'>shell@android:/ <span class="err">$</span>
</span></code></pre></td></tr></table></div></figure>


<p>これでパズドラは起動しますし、TwonkyBeam で DTCP-IP が使えるようになりました。<br/>
nasneで録画した動画やライブチューナでテレビも見られます！</p>

<p>しかしまだ終わりません。先ほどの <strong>swsu.sh</strong> を実行してみます。<br/>
動きませんね。<br/>
この状態だと su (sux) が動かないことに気が付きます。<br/>
なぜか確認なしにsuが拒否されてしまうのです。
logcat には次のように出力されています。</p>

<figure class='code'><figcaption><span>terminal</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>W/su      ( 8151): request rejected (10097-&gt;0 /system/bin/sh) F8?HO?
</span><span class='line'>D/su      ( 8147): su invoked.
</span><span class='line'>D/su      ( 8149): access_disabled
</span><span class='line'>E/su      ( 8148): Root access is disabled on non-debug builds
</span></code></pre></td></tr></table></div></figure>


<p>なるほど。<br/>
実は CyanogenMod で提供している su は変更が加えてあり、 <em>ro.debuggable=0</em> では無条件に拒否するようになっています。</p>

<p>しかし、<a href="https://github.com/CyanogenMod/Superuser/blob/379371bcff3f18b4a16beb37a35c2b211a941781/Superuser/jni/su/su.c#L548">ソース</a>をみてみると、runtime に <strong>/default.prop</strong> を見ているだけのようなので、システムが起動した後に <strong>/default.prop</strong> を書き換えてやればよさそうです。<br/>
でも、あれ？？？<br/>
でも起動したら su 使えないし書き換えられないんじゃ？<br/>
はい。そうです。そこで先ほどの <strong>userinit.sh</strong> に追記します。 <strong>userinit.sh</strong> は root権限で動きますからね。</p>

<p>普通に再起動して以下を<strong>追記</strong>した <strong>userinit.sh</strong> を改めて <strong>/data/local/userinit.sh</strong> へ置きます。 <strong>chmod 0755</strong> を忘れずに。(recovery で adb が使えれば recovery で作業してもいいです)</p>

<figure class='code'><figcaption><span>/data/local/userinit.sh(抜粋)</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#</span>
</span><span class='line'><span class="c"># /default.prop書換え</span>
</span><span class='line'>mount -o remount,rw /
</span><span class='line'>sed -e <span class="s1">&#39;s/ro.debuggable=0/ro.debuggable=1/g&#39;</span> /default.prop &gt; /default.prop.tmp
</span><span class='line'>mv /default.prop.tmp /default.prop
</span><span class='line'>chmod 0644 /default.prop
</span><span class='line'>mount -o remount,ro /
</span></code></pre></td></tr></table></div></figure>


<p>これでもう一度 fastboot boot newboot.img して確認してみましょう。</p>

<figure class='code'><figcaption><span>terminal</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>adb reboot bootloader
</span><span class='line'><span class="nv">$ </span>sudo fastboot boot newboot.img
</span><span class='line'><span class="nv">$ </span>adb shell
</span><span class='line'>shel@android:/ <span class="nv">$ </span>getprop ro.debuggable
</span><span class='line'>0
</span><span class='line'>shell@android:/ <span class="nv">$ </span>sux
</span><span class='line'>shell@android:/ <span class="c">#</span>
</span></code></pre></td></tr></table></div></figure>


<p>うまく行きました。<br/>
満を持して newboot.img を fastboot で flash しましょう。</p>

<figure class='code'><figcaption><span>terminal</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>adb reboot bootloader
</span><span class='line'><span class="nv">$ </span>sudo fastboot flash boot newboot.img
</span></code></pre></td></tr></table></div></figure>


<p>そんなわけで、/data/local/ は wipe しない限り維持できますから、今後はアップデートするときに boot.img を改変するだけでよくなります。<br/>
boot.img の改変は面倒ですが、手順は決まっているしスクリプトにすれば自動化はできるかと思います。<br/>
(というか前述の手順がスクリプトそのものっぽい)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LXC コンテナで avahi-daemon を動かす]]></title>
    <link href="http://note.n6e.be/blog/2013/06/11/avahi-daemon-in-lxc-container/"/>
    <updated>2013-06-11T16:41:00+09:00</updated>
    <id>http://note.n6e.be/blog/2013/06/11/avahi-daemon-in-lxc-container</id>
    <content type="html"><![CDATA[<p>LXCコンテナが役割ごとに増殖してて、DHCPつかってアドレス振ってると、振られたIPアドレス調べたり色々面倒なのでmDNSでアレしたいなと。</p>

<p>というわけで mDNS であるところの <strong>avahi-daemon</strong> を動かそうとしたんですが動きませんのでメモ。</p>

<!-- more -->


<p>調べによるとLXCのコンテナでは <strong>setrlimit(2)</strong> システムコールが使えないらしいです。<br/>
<strong>avahi-daemon</strong> はデフォルトでこのシステムコールを使うので起動しません。<br/>
で、オプションに <em>&mdash;no-rlimits</em> をつけて起動すれば良いとのこと。</p>

<p>Ubuntuだとこのへん (/etc/init/avahi-daemon.conf) の opts に <em>&mdash;no-rlimits</em> を追加</p>

<figure class='code'><figcaption><span>/etc/init/avahi-daemon.conf</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c"># avahi-daemon - mDNS/DNS-SD daemon</span>
</span><span class='line'><span class="c">#</span>
</span><span class='line'><span class="c"># The Avahi daemon provides mDNS/DNS-SD discovery support (Bonjour/Zeroconf)</span>
</span><span class='line'><span class="c"># allowing applications to discover services on the network.</span>
</span><span class='line'>
</span><span class='line'>description     <span class="s2">&quot;mDNS/DNS-SD daemon&quot;</span>
</span><span class='line'>
</span><span class='line'>start on <span class="o">(</span>filesystem
</span><span class='line'>          and started dbus<span class="o">)</span>
</span><span class='line'>stop on stopping dbus
</span><span class='line'>
</span><span class='line'>expect daemon
</span><span class='line'>respawn
</span><span class='line'>
</span><span class='line'>pre-start script
</span><span class='line'>    /lib/init/apparmor-profile-load usr.sbin.avahi-daemon
</span><span class='line'>end script
</span><span class='line'>
</span><span class='line'>script
</span><span class='line'>        <span class="nv">opts</span><span class="o">=</span><span class="s2">&quot;-D --no-rlimits&quot;</span>
</span><span class='line'>        <span class="o">[</span> -e <span class="s2">&quot;/etc/eucalyptus/avahi-daemon.conf&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">opts</span><span class="o">=</span><span class="s2">&quot;${opts} -f /etc/eucalyptus/avahi-daemon.conf&quot;</span>
</span><span class='line'>        <span class="nb">exec </span>avahi-daemon <span class="k">${</span><span class="nv">opts</span><span class="k">}</span>
</span><span class='line'>end script
</span></code></pre></td></tr></table></div></figure>


<p>これで動くので <em>hostname.local</em> といった名前でコンテナにアクセスできるようになりました。<br/>
<em>&mdash;no-rlimits</em> でどういう影響がでるのかは調べていません。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ffmpeg で ustream 配信したメモ]]></title>
    <link href="http://note.n6e.be/blog/2013/05/30/ffmpeg-de-ustream/"/>
    <updated>2013-05-30T17:26:00+09:00</updated>
    <id>http://note.n6e.be/blog/2013/05/30/ffmpeg-de-ustream</id>
    <content type="html"><![CDATA[<p>どうも。</p>

<p>当方、<a href="http://ustream.tv/channel/northeye">Ustreamで猫カメラ</a>を運用しているのだけれど、FlashMediaEncoderを動かしていたWindowsがとても不安定で廃絶してしまったので、どうしようかと思っていました。<br/>
それと、常時稼動マシンは減らしたい。<br/>
そんなわけでいつも動いているNASマシンかルーターマシンで動かすことにしました。</p>

<!-- more -->


<p>NASやルーターはだいたいLinuxでやってるのでLinuxでやることになります。<br/>
KVMにWindows環境つくってPCIパススルーでUSBデバイスをスルーして配信することも可能ですが、エンコードというプロセスが存在するため、ある程度のパフォーマンスが必要になり、仮想環境ではなかなか無理がありました。(試したけどやめた)</p>

<p>そんなわけで、今回はルーターにffmpegいれてこいつでやってみます。<br/>
ちなみにカメラデバイスはLogicoolのC910というHDウェブカメラで、ステレオマイクがついています。<br/>
※ もう売ってなくて<a href="http://amzn.to/11dbZvi">C920</a>という機種が後継のようです。</p>

<h2>lxcで環境構築</h2>

<p>しかしながら、ルーターのような重要なマシンに余計なものを入れたくないのも事実。<br/>
そこでlxcのコンテナで環境を分離します。あとで別のマシンでやりたくなったとき移行も簡単なので便利です。<br/>
lxcの環境構築は省略して、ポイントだけ。</p>

<p>lxcの設定ファイルにv4l2とsndのcgroupパーミッションを追加します。</p>

<pre><code># v4l2
lxc.cgroup.devices.allow = c 81:* rwm
# sound
lxc.cgroup.devices.allow = c 116:* rwm
</code></pre>

<p>ホスト側の/dev/sndをbind mountしときます。</p>

<pre><code>% sudo mount --bind /dev/snd /lxc/ustream/rootfs/dev/snd
</code></pre>

<p>lxcをstartします。</p>

<pre><code>% sudo lxc-start -n ustream -d
</code></pre>

<p>以降はlxc環境での操作になります。<br/>
ffmpegはubuntuやdebianのだとlibavになってるのでdeb-multimedia.orgから入れます。</p>

<pre><code># echo "deb http://www.deb-multimedia.org sid main non-free" &gt; /etc/apt/sources.list.d/multimedia.list
# echo 'APT::Install-Recommends "0";' &gt; /etc/apt/apt.conf.d/99norecommends 
# apt-get update
# apt-get install ffmpeg alsa-utils
</code></pre>

<p>自分をaudioとvideoのグループに追加して、/dev/video0 や /dev/snd あたりのパーミッション確認をしときましょう。<br/>
カメラは単にUSBカメラさすだけで /dev/video0 は参照できました。<br/>
audioの方ですがひとまず /proc/asound あたりを見てどういう状態か確認します。pulse audioはよく知りません。</p>

<pre><code>% cat /proc/asound/cards
 0 [PCH            ]: HDA-Intel - HDA Intel PCH
                      HDA Intel PCH at 0xfe700000 irq 63
 1 [U0x46d0x821    ]: USB-Audio - USB Device 0x46d:0x821
                      USB Device 0x46d:0x821 at usb-0000:00:1d.0-1.7.4, high speed
% cat /proc/asound/devices
  2: [ 0- 3]: digital audio playback
  3: [ 0- 2]: digital audio capture
  4: [ 0- 1]: digital audio playback
  5: [ 0- 0]: digital audio playback
  6: [ 0- 0]: digital audio capture
  7: [ 0- 3]: hardware dependent
  8: [ 0- 2]: hardware dependent
  9: [ 0]   : control
 10: [ 1- 0]: digital audio capture
 11: [ 1]   : control
 33:        : timer
</code></pre>

<p>というわけで、card  1がUSBカメラのマイクっぽくて、1-0がキャプチャのようなので ffmpeg で渡すオプションには hw:1,0で良さげです。</p>

<h2>Ustreamの配信用RTMP URL</h2>

<p>ustreamの配信先URLを確認します。<br/>
ログインしてダッシュボード→番組設定→リモート のところに RTMP URLとストリームキーがあるので、結合してひとつのURLにします。
( URL + &ldquo;/&rdquo; + キー )</p>

<h2>ffmpeg の実行</h2>

<p>ffmpeg を実行してみます。</p>

<pre><code>% ffmpeg -f v4l2 -i /dev/video0 -ac 2 -f alsa -i hw:1,0 -c:a libfaac -ar 22050 -b:a 48k -c:v libx264 -preset veryfast -threads auto -vsync 1 -f flv 'rtmp://1.xxx.fme.ustream.tv/ustreamVideo/xxxxxx/&lt;キー&gt; flashver=FME/3.0\20(compatible;\20FMSc/1.0)'
</code></pre>

<p>とまぁこんな感じです。<br/>
x264のプリセットはveryfastとかにしたほうが遅延が少なくてすむのかなと思いました。</p>

<h2>TIPS</h2>

<p>とりあえず ffmpeg のオプションの順番には意味があるので注意しましょう。</p>

<h3>マイクのミュートとかを動的にやりたい。</h3>

<p>ffmpegを止めずにマイクのオンオフはできたほうがいいですね。</p>

<pre><code>% alsamixer -c 1 
</code></pre>

<p>してF4でキャプチャのミキサーにしてSPACEキーでトグル。</p>

<h3>iOSやAndroidのアプリで視聴できるフォーマットにしたい</h3>

<p>いろいろ調べましたが、baseline profileでLevel3.0ならいいらしいです。<br/>
対応するffmpegのオプションは</p>

<pre><code>-profile:v baseline -level 3.0 
</code></pre>

<p>ということなのですが、ただこれをつけただけだと</p>

<pre><code>x264 [error]: baseline profile doesn't support 4:2:2
[libx264 @ 0xb7fa40] Error setting profile baseline.
</code></pre>

<p>となり失敗します。<br/>
どうやらpixel formatがよくないようで、さらに</p>

<pre><code>-pix_fmt yuv420p
</code></pre>

<p>というオプションをつければ良いようです。</p>

<h3>たまにffmpegが死ぬ</h3>

<p>Ustreamサーバの調子にも左右されますがごく稀にffmpegプロセスが死んでますので。</p>

<pre><code>% while true; do
ffmpeg -r 15 -s 640x360 -f v4l2 -i /dev/video0 -ac 2 -f alsa -i hw:1,0 -acodec libfaac -ar 22050 -b:a 48k -c:v libx264 -profile:v baseline -level 3.0 -preset veryfast -pix_fmt yuv420p -threads 3 -vsync 1 -y -f flv 'rtmp://1.xxxx.fme.ustream.tv/ustreamVideo/streamid/streamkey flashver=FME/3.0\20(compatible;\20FMSc/1.0)'
sleep 5
done
</code></pre>

<p>みたいに実行するようにしました。</p>

<h3>オーディオのキャプチャができない</h3>

<p>当方で遭遇したのはマイクのチャンネル数を合わせないといけないという事でした。<br/>
マイクがモノラルなら -ac 1 、ステレオなら -ac 2 としないといけないようです。</p>

<h3>ホワイトバランスなどの調整</h3>

<p>v4l2-ctl -c でやります。<br/>
v4l2-ctl -L で何ができるかわかります。</p>

<pre><code>% v4l2-ctl -L 
                     brightness (int)    : min=0 max=255 step=1 default=128 value=128
                       contrast (int)    : min=0 max=255 step=1 default=32 value=32
                     saturation (int)    : min=0 max=255 step=1 default=32 value=32
 white_balance_temperature_auto (bool)   : default=1 value=0
                           gain (int)    : min=0 max=255 step=1 default=64 value=57
           power_line_frequency (menu)   : min=0 max=2 default=2 value=2
                0: Disabled
                1: 50 Hz
                2: 60 Hz
      white_balance_temperature (int)    : min=2800 max=6500 step=1 default=4000 value=4300
                      sharpness (int)    : min=0 max=255 step=1 default=72 value=72
         backlight_compensation (int)    : min=0 max=1 step=1 default=0 value=0
                  exposure_auto (menu)   : min=0 max=3 default=3 value=3
                1: Manual Mode
                3: Aperture Priority Mode
              exposure_absolute (int)    : min=3 max=2047 step=1 default=166 value=415 flags=inactive
         exposure_auto_priority (bool)   : default=0 value=1
                   pan_absolute (int)    : min=-36000 max=36000 step=3600 default=0 value=0
                  tilt_absolute (int)    : min=-36000 max=36000 step=3600 default=0 value=0
                 focus_absolute (int)    : min=0 max=255 step=17 default=68 value=0
                     focus_auto (bool)   : default=1 value=0
                  zoom_absolute (int)    : min=1 max=5 step=1 default=1 value=1

% v4l2-ctl -c white_balance_temperature=4300
</code></pre>

<p>ffmpeg 実行するたびにリセットされる気がする。</p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B006NTPLJW" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B001VA2L4Q" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Xperia（TM）ワールド タッチ＆トライ ブロガーミーティングに参加しました(先月)]]></title>
    <link href="http://note.n6e.be/blog/2013/02/14/xperia-world-touch-try/"/>
    <updated>2013-02-14T20:23:00+09:00</updated>
    <id>http://note.n6e.be/blog/2013/02/14/xperia-world-touch-try</id>
    <content type="html"><![CDATA[<p><img class="right" src="http://farm9.staticflickr.com/8092/8407636657_dd10cb17a9_n_d.jpg">
明けましておめでとう御座います。<br/>
もうXperia Zが発売して約一週間が過ぎ、先月のことになってしまいましたがXperia (主にXperia Z)のタッチ＆トライイベントに参加してきましたのでリポートです。</p>

<!-- more -->


<p>イベント自体はコジャレた場所で開催され、軽食もあり、試用端末も一人一台ずつ渡してくれて大変好印象でした。<br/>
肝心のデバイスの方ですが、ぶっちゃけそんなに興味惹かれることはありませんでした。<br/>
というのも、僕はすでに同グレードにあたる5インチフルHD端末機 HTC J butterfly(HTL21)を所有していて、それとの比較をすると大して抜きん出た部分がなかったからです。<br/>
それとXperia Tablet Zのほうはそもそもタブレットにあまり興味がなかったのでほぼスルー気味でしたが、筐体の薄さだけは確認してきました。</p>

<p>さて実際の比較ポイントなんですが、中身はAndroid 4.1なんでほぼ同じ、カタログスペックでのハードウェア性能もだいたい同じ、UIがXperiaかHTCかの違い程度くらいしかと思います。大雑把ですが…。<br/>
どっちを買えばいいかと言われたら「どっちでもいい、見た感じで」と言えるレベル。</p>

<p>たとえば、カメラのモードレスUIとか、動画撮影中にも静止画を撮影可能と自信ありげに説明いただきましたが、HTL21でも同様です。<br/>
<a href="http://www.flickr.com/photos/xnortheye/8409288889/in/set-72157632598441208" target="_blank"><img src="http://farm9.staticflickr.com/8225/8409288889_bd74d8d0e3_d.jpg"></a></p>

<p>画素数ではXperiaのほうが13Mなのでだいぶ上ですね。<br/>
カメラの起動の速さではHTL21のほうが速かったですが、初回以降はあまりそこまで変わりませんでした。<br/>
ちなみに近くにあったオブジェを撮影したものがこちら。<br/>
<a href="http://www.flickr.com/photos/xnortheye/8409289141/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8360/8409289141_3fa539be9c_n_d.jpg"></a></p>

<p>あ、ステータスバーのプルダウンに各種トグルスイッチがあるのはまぁ便利ですね。<br/>
<a href="http://www.flickr.com/photos/xnortheye/8410384660/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8323/8410384660_60f614e20a_d.jpg"></a></p>

<p>POBoxのキーボードはリサイズできるようになったようです。<br/>
僕はATOKつかってるんですがこちらもリサイズ可能ですがPOBoxのほうが柔軟にリサイズデキルような気がしました。<br/>
<a href="http://www.flickr.com/photos/xnortheye/8409288943/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8091/8409288943_f60d8de72f_n_d.jpg"></a></p>

<p>その他僕がまず気にする部分は /proc/meminfo の情報です。ユーザーが利用できるメモリ量はここで決まります。<br/>
Xperiaは MemTotal 1.8GB程度、HTL21は1.6GBなので、どっちがいいって言えばそりゃXperiaですが、1.5GBを超えると2.0GBまではまぁ誤差でいいかなとか思ってしまいます。<br/>
だいたいいつも400MBくらいは空いてるから。<br/>
<a href="http://www.flickr.com/photos/xnortheye/8409289003/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8079/8409289003_cd6bae1c2c_d.jpg"></a></p>

<p>次に気になるのがタッチイベントを何点拾えるか…なんですが今時はだいたいどれも10点いけるので最早どうでもよくなりました。<br/>
実際XperiaもHTL21も10点いけます。初代Xperiaは1点だったのでひどかったですね。</p>

<p>続いて筐体の大きさ具合。<br/>
これも誤差レベルの違いしかないかなぁ…と思いますです。<br/>
Xperiaはイヤホン端子に蓋があるが、HTL21にはありません。<br/>
HTL21のUSB蓋は取れやすい(が、アロンアルファで接着しなおせば取れない)が、Xperiaのほうはそうそう取れないと思います。(IS12Sでの感想)<br/>
<a href="http://www.flickr.com/photos/xnortheye/8408732254/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8361/8408732254_8b6cb18cf9_n_d.jpg"></a><br/>
 (左Xperia Z,右HTL21)</p>

<p><a href="http://www.flickr.com/photos/xnortheye/8407630125/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8507/8407630125_fa4179ea99_n_d.jpg"></a><br/>
 HTL21は裏面が湾曲しているので端が浮いてます。最薄部分ではHTL21のほうが薄いかな。</p>

<p>ストラップホールがついているのは日本ではプラスポイントかもしれませんね。<br/>
<a href="http://www.flickr.com/photos/xnortheye/8407616023/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8373/8407616023_2e3d7f8819_n_d.jpg"></a></p>

<p>最後に、Xperia Tablet Zの薄さはまぁ薄かったです。<br/>
でも解像度、2560x1600のNexus10があることを考えると全く惹かれませんし、どう考えてもNexus10買ったほうがいいですね。<br/>
<a href="http://www.flickr.com/photos/xnortheye/8407617267/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8232/8407617267_a0ea5142e7_n_d.jpg"></a>
<a href="http://www.flickr.com/photos/xnortheye/8407617961/in/set-72157632598441208/" target="_blank"><img src="http://farm9.staticflickr.com/8473/8407617961_563868cafb_n_d.jpg"></a></p>

<p>おみやげにXperia缶バッジと<a href="http://pur.store.sony.jp/Qnavi/Product/CP-F1LSVP/">モバイルバッテリー</a>を頂きました。<br/>
その他全ての写真は<a href="http://www.flickr.com/photos/xnortheye/sets/72157632598441208/">flickr</a>に。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[猫にマカロンベッドを買ってあげた]]></title>
    <link href="http://note.n6e.be/blog/2012/10/23/macaron-bed-for-cats/"/>
    <updated>2012-10-23T23:37:00+09:00</updated>
    <id>http://note.n6e.be/blog/2012/10/23/macaron-bed-for-cats</id>
    <content type="html"><![CDATA[<p>そろそろ寒いし、楽天みてたら2012年版とやらが売っていたので買いました。<br/>
去年はこれ売り切れまくりで全く買えなかったけど買えました。</p>

<!-- more -->


<p>けっこう気に入ってる模様！
<a href="http://farm9.staticflickr.com/8331/8100404536_ee1906bce2_c_d.jpg" target="_blank"><img src="http://farm9.staticflickr.com/8331/8100404536_ee1906bce2_n_d.jpg"></a>
<a href="http://farm9.staticflickr.com/8334/8100291298_78bd87b96e_c_d.jpg" target="_blank"><img src="http://farm9.staticflickr.com/8334/8100291298_78bd87b96e_n_d.jpg"></a></p>

<p>あ、Amazonにもありますね。売り切れないうちに買いましょう。</p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B008ZVMQ4Y" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B008ZVMQ3A" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B008ZVMQ6W" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[iOS6はAVRCP1.3でMW600とかに曲名表示できる]]></title>
    <link href="http://note.n6e.be/blog/2012/10/19/ios6-avrcp-1-3/"/>
    <updated>2012-10-19T15:47:00+09:00</updated>
    <id>http://note.n6e.be/blog/2012/10/19/ios6-avrcp-1-3</id>
    <content type="html"><![CDATA[<p>iPhone5にして気がついたのですが、MW600やAT-PHA05BTでの曲名表示が可能になってました。<br/>
iOS6からかなと思います。便利。<br/>
<a href="http://farm9.staticflickr.com/8464/8118329335_aa039c13f3_d.jpg" target="_blank"><img src="http://farm9.staticflickr.com/8464/8118329335_aa039c13f3_m_d.jpg"></a></p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B0065V9TXC" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B0087BQCHE" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B003N111Y2" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Amazon BasicのHDMIケーブル安い]]></title>
    <link href="http://note.n6e.be/blog/2012/10/17/amazon-basic-hdmi-cable/"/>
    <updated>2012-10-17T15:58:00+09:00</updated>
    <id>http://note.n6e.be/blog/2012/10/17/amazon-basic-hdmi-cable</id>
    <content type="html"><![CDATA[<p>安いし品質良さそうだし便利。<br/>
名のあるメーカー品買うのアホらしい。</p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B003L1ZYYM" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B0052SCU8U" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[twicca - Evernote プラグイン 1.7.0 release]]></title>
    <link href="http://note.n6e.be/blog/2012/10/16/twicca-evernote-plugin-1-7-0-release/"/>
    <updated>2012-10-16T23:46:00+09:00</updated>
    <id>http://note.n6e.be/blog/2012/10/16/twicca-evernote-plugin-1-7-0-release</id>
    <content type="html"><![CDATA[<p><a href="https://play.google.com/store/apps/details?id=jp.takuo.android.twicca.plugin.evernote">twicca &ndash; Evernote プラグイン</a> 1.7.0 をリリースしました。<br/>
2012/11 よりパスワード認証でのサービス提供が終了することに伴い、Evernoteサービスの認証にOAuthを使うようになりました。</p>

<!-- more -->


<p>認証手順で若干の不具合があり、ブラウザでOAuth認証した後設定画面に戻るのですが、そこからさらにブラウザが立ち上がってしまいます。
認証自体は正常に終了していますのでそのままブラウザを終了して問題ありません。</p>

<p>Evernote SDKでのintent処理に問題がある気がしていますが、試行錯誤したものの修正できなかったのでとりあえずこの状態でのリリースになっています。<br/>
後ほどSDKを使わないでOAuthを処理する方法を試し修正していきたいと思います。</p>

<p>※ SDKサイズが増えAPKのサイズも増大してしまいました。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[AppleTV買った]]></title>
    <link href="http://note.n6e.be/blog/2012/10/14/appletv/"/>
    <updated>2012-10-14T15:13:00+09:00</updated>
    <id>http://note.n6e.be/blog/2012/10/14/appletv</id>
    <content type="html"><![CDATA[<p>AppleTV(っていうかAirPlay)最高！すごい！素晴らしい！みたいなエントリにしようと思ったんですがね。<br/>
というのも使っていたdockコネクタスピーカーTSX-70がiPhone5にしてから使えなくなったんでね、AppleTV買って満足してたんですよ。</p>

<!-- more -->


<p>Youtubeが見られるとかHuluが見られるとかわりとどうでもよくて、iTunesやiPhoneに貯めこんであるオーディオビジュアル資産をAVアンプで再生できるってことが最高なんですよ。<br/>
やっぱそれなりのアンプとスピーカーを揃えている身としては是非とも有効活用してまいりたい。<br/>
そこでこのAppleTVだったわけですね。大変便利だし、今までなんで買わなかったのかわからないし、AVアンプの類もっててAppleTVもってないのは頭おかしいとしか思えない。</p>

<p>そんで、これはAVアンプの新調機運きてるなーみたいに思ってYAMAHAのサイトみてたら、どうやら最近のAVアンプは単体でAirPlay対応なんですね。<br/>
AppleTVいらねえじゃん！っていう。</p>

<p>まぁどの程度の対応レベルかは使ってみないとわかりませんが、dockコネクタスピーカー以上のものであることは間違いない。
AppleTVもまぁ安いしAirPlayミラーリングとか面白いしホームシェアリングでライブラリ再生できるしリモコンはクソみたいに使いづらいしおもちゃとしていっかぁ…ってなってる。<br/>
そんなわけで、<a href="http://jp.yamaha.com/products/audio-visual/av-amplifiers/rx-a2020_black__j/">YAMAHA AVENTAGE RX-A2020</a>の購入を決意して<a href="http://kakaku.com/item/K0000399339/">価格.com</a>を眺める毎日です。マジ。</p>

<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B007JQGUW0" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>


<iframe src="http://rcm-jp.amazon.co.jp/e/cm?lt1=_blank&bc1=000000&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=takuojp02-22&o=9&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=B0094LZ1VE" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>



]]></content>
  </entry>
  
</feed>
